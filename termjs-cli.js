// Generated by CoffeeScript 1.8.0
var readline, socketio;

socketio = require('socket.io-client');

readline = require('readline');

module.exports = function(url, cb) {
  var pty, rl, socket;
  if (cb == null) {
    cb = null;
  }
  socket = socketio.connect(url);
  pty = null;
  rl = readline.createInterface({
    input: process.stdin,
    output: process.stdout
  });
  rl.on('line', function(line) {
    return socket.emit('data', pty, "" + line + "\n");
  });
  rl.on('SIGINT', function() {
    rl.pause();
    return socket.disconnect();
  });
  return socket.on('connect', function() {
    socket.on('data', function(pty, data) {
      return process.stdout.write(data);
    });
    socket.emit('create', 80, 25, function(err, data) {
      return pty = data.id;
    });
    return socket.on('disconnect', function() {
      if (cb != null) {
        return cb(null);
      }
    });
  });
};
